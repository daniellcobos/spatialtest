<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Random Generator</title>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.0.0/legacy/ol.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@main/dist/en/v7.0.0/legacy/ol.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <style>
        .map {
            height: 400px;
            width: 100%;
        }
    </style>

</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
             <a class="navbar-brand" href="#">Synapsis</a>
             <a class="navbar-brand" href="/prox">Muestreo por proximidad a puntos</a>
        </div>
    </nav>
     <div class="container mt-5">
                  <h3>Residencias clasificadas por estrato</h3>
         <div class="row">
             <div class="col-sm">
            <form action="{{ url_for('muestreo') }}" method="POST" name="data" id="data">
                    <label for="ciudad"> Seleccione una ciudad</label><br>
                    <select name="ciudad" id="ciudad">
                         <option value="Bogota" selected>Bogota</option>
                        <option value="Medellin">Medellin </option>
                        <option value="Barranquilla" >Barranquilla</option>
                        <option value="Cali">Cali</option>
                    </select><br>
                  <label for="proporcion"> Seleccione tipo de Proporcion</label><br>
                    <select name="proporcion" id="proporcion">
                        <option value="prop1" selected>No Proporcional</option>
                        <option value="prop2" >Proporcional</option>

                    </select><br>
                    <label for="punto1"> Ingrese los puntos por estrato (No-Proporcional)</label><br>
                    <input type="number" name="puntos1" id="puntos1" value=1></input><br>
                    <label for="punto2"> Ingrese la proporcion por grupo (Proporcional)</label><br>
                    <input type="number" name="puntos2" id="puntos2" value=1></input><br>
                    <button> Enviar datos</button>
                </form>
             </div>
             <div class="col-sm">
                  <div id="map" class="map"></div>
             </div>
         </div>
         <div class="row">
            <table class="table">
                <thead>
                <tr>
                    <th>Id</th>
                    <th>Direccion</th>
                    <th>Estrato</th>
                </tr>
                </thead>
                <tbody id="tablebody">

                </tbody>
            </table>
         </div>

         </div>
</body>
<script>
   const sample = {{ sample | safe }}
   const tablebody = document.getElementById("tablebody")
  console.log(sample)

   for (let e of sample.features){
       tr = document.createElement("tr")
       tdid = document.createElement("td")
       tdid.innerText = e.id
       tddir = document.createElement("td")
       tddir.innerText =e.properties.direccion
       tdes = document.createElement("td")
       tdes.innerText = e.properties.estrato
       tr.appendChild(tdid)
       tr.appendChild(tddir)
       tr.appendChild(tdes)
       tablebody.appendChild(tr)
   }

           var styles = {
                'MultiPolygon': new ol.style.Style({
                stroke: new ol.style.Stroke({
          color: 'yellow',
          width: 1,
        }),
        fill: new ol.style.Fill({
          color: 'rgba(255, 255, 0, 0.1)',
        }),
      }),
      'Polygon': new ol.style.Style({
             stroke: new ol.style.Stroke({
          color: 'blue',
          lineDash: [4],
          width: 3,

    }),
        fill: new ol.style.Fill({
          color: 'rgba(255, 255, 0, 0.1)',
        }),
      })
        }

        const styleFunction = function (feature) {
               const f= feature.getProperties()
            console.log(f)
            const estrato = f.estrato
            let color = 'black'
             if (estrato === 1) {
                colortext = 'Tomato'
            }
            if (estrato === 2) {
                colortext = 'Olive'

            }
            if (estrato === 3) {
                colortext = 'RoyalBlue'
            }
             if (estrato === 4) {
                colortext = 'DarkSeaGreen'
            }
            if (estrato === 5) {
                colortext = "purple"

            }
            if (estrato === 6) {
                colortext = "Gold"
            }
           return new ol.style.Style({
    image: new ol.style.Circle({

      fill: new ol.style.Fill({
        color: colortext
      }),
      stroke: new ol.style.Stroke({
        color: colortext,
        width: 3
      }),
      radius: 5
    })
  });

        };

       var vectorSource = new ol.source.Vector({
            features: new ol.format.GeoJSON().readFeatures(sample)
        });

        var vectorLayer = new ol.layer.Vector({
            source: vectorSource,
            style: styleFunction,
        });




        var extent = vectorSource.getExtent();
        //map.getView().fit(extent);


        var map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM()
                }), vectorLayer
            ],
            view: new ol.View({
                projection: 'EPSG:4326',
                center: [-74.08083,4.593333],
                zoom: 13
            }),

        });


</script>

</html>